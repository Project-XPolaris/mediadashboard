"use strict";(self.webpackChunkmediadashboard=self.webpackChunkmediadashboard||[]).push([[656],{83672:function(Ie,ee,n){n.d(ee,{Z:function(){return _}});var ne=n(48305),l=n.n(ne),Q=n(4855),O=n(92094),q=n(85408),R={title:"title___MU09b",addButton:"addButton___XIDmz",selectInput:"selectInput___DPjPn"},le=n(10259),P=n(91480),E=n(4637),b=Q.Z.Option;function _(ae){var xe=ae.orderItems,de=ae.onAddFilter,U=ae.defaultOrderKey,se=(0,le.Z)(),Te=l()(se,1),w=Te[0],ie=xe.map(function(te){return(0,E.jsx)(b,{value:te.key,children:te.title},te.key)}),Ne=function(Le){var Oe=Le.orderKey,ze=Oe===void 0?U:Oe,Pe=Le.order,e=Pe===void 0?"asc":Pe;de(ze,e)};return(0,E.jsx)(P.Z,{title:"Order",children:(0,E.jsxs)(O.Z,{form:w,onFinish:Ne,children:[(0,E.jsx)(O.Z.Item,{label:"Order key",name:"orderKey",children:(0,E.jsx)(Q.Z,{size:"small",defaultValue:U,className:R.selectInput,style:{width:120},children:ie})}),(0,E.jsx)(O.Z.Item,{label:"Order",name:"order",children:(0,E.jsxs)(Q.Z,{defaultValue:"asc",size:"small",className:R.selectInput,style:{width:120},children:[(0,E.jsx)(b,{value:"asc",children:"ASC"}),(0,E.jsx)(b,{value:"desc",children:"Desc"})]})}),(0,E.jsx)(q.ZP,{type:"primary",htmlType:"submit",className:R.addButton,children:"Add"})]})})}},2111:function(Ie,ee,n){n.d(ee,{Z:function(){return E}});var ne=n(48305),l=n.n(ne),Q=n(59496),O=n(50468),q=n(85408),R={addButton:"addButton___nJWv1",nameInput:"nameInput___KNqsv"},le=n(91480),P=n(4637),E=function(b){var _=b.onSetSearchName,ae=b.title,xe=(0,Q.useState)(void 0),de=l()(xe,2),U=de[0],se=de[1],Te=function(Ne){var te=Ne.currentTarget.value;te!==void 0&&te.length!==0&&se(te)},w=function(){U!==void 0&&_(U)};return(0,P.jsxs)(le.Z,{title:ae,children:[(0,P.jsx)(O.Z,{placeholder:"Search name",size:"small",className:R.nameInput,onChange:Te}),(0,P.jsx)(q.ZP,{type:"primary",htmlType:"submit",className:R.addButton,onClick:w,disabled:U===void 0||U.length===0,children:"Add"})]})}},91480:function(Ie,ee,n){n.d(ee,{Z:function(){return Q}});var ne={title:"title___ckLLH"},l=n(4637);function Q(O){var q=O.children,R=O.title;return(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:ne.title,children:R}),q]})}},88991:function(Ie,ee,n){n.d(ee,{Z:function(){return P}});var ne=n(26068),l=n.n(ne),Q=n(67825),O=n.n(Q),q=n(4637),R=["url","className","alt"],le=n(36812);function P(E){var b,_=E.url,ae=E.className,xe=E.alt,de=O()(E,R);if(!_)return(0,q.jsx)("div",{className:ae});var U=(b=localStorage.getItem("token"))!==null&&b!==void 0?b:"",se=le(_).addQuery("a",U).readable();return(0,q.jsx)("img",l()({src:"/api/comic"+se,className:ae,alt:xe},de))}},93011:function(Ie,ee,n){n.r(ee),n.d(ee,{default:function(){return Vn}});var ne=n(26068),l=n.n(ne),Q=n(90228),O=n.n(Q),q=n(87999),R=n.n(q),le=n(15558),P=n.n(le),E=n(48305),b=n.n(E),_=n(87218),ae=n(31220),xe=n(34298),de={main:"main___glbJS"},U=n(44307),se=n(21201),Te=n(43591),w={main:"main___wi6os",cover:"cover___ozUSv",title:"title___qSixC",author:"author___SHJtI",titleSelected:"titleSelected___EZjA0",authorSelected:"authorSelected___NB2L0",coverWrap:"coverWrap___ahiN5",cardContentSelected:"cardContentSelected___ePnaq",content:"content___bQauG",info:"info___Zzda1",meta:"meta___mjFvV",icon:"icon___FWEZD"},ie=n(31603),Ne=n(60754),te=n.n(Ne),Le=n(93583),Oe=n.n(Le),ze=n(88991),Pe=n(50451),e=n(4637),an=function(r){var t=r.book,f=r.onSelectAction,s=r.onAddToCollectionAction,u=r.isSelected,y=u===void 0?!1:u,B=r.onBookClick,p=r.onParseFromName,T=(0,Pe.i)(t),k=T.author,d=T.series,o=T.theme,i=function(){t&&f(t)},F=function(){t&&s(t)},A=function(){t&&p(t)},S=(0,e.jsxs)(U.Z,{children:[(0,e.jsxs)(U.Z.Item,{onClick:i,children:[(0,e.jsx)(te(),{}),y?"\u53D6\u6D88\u9009\u4E2D":"\u9009\u4E2D"]},"1"),(0,e.jsxs)(U.Z.Item,{onClick:F,children:[(0,e.jsx)(Oe(),{}),"\u52A0\u5165\u96C6\u5408"]},"2"),(0,e.jsxs)(U.Z.Item,{onClick:A,children:[(0,e.jsx)(ie.EditOutlined,{}),"\u4ECE\u6587\u4EF6\u540D\u89E3\u6790"]},"3")]}),N=function(){B===void 0||!t||B(t)};return(0,e.jsx)(se.Z,{overlay:S,trigger:["contextMenu"],children:(0,e.jsx)(Te.Z,{bodyStyle:{padding:0},className:w.main,hoverable:!0,onClick:N,children:(0,e.jsxs)("div",{className:w.content,style:{backgroundColor:y?"#1890ff":void 0},children:[(0,e.jsx)(ze.Z,{className:w.cover,url:t==null?void 0:t.cover}),(0,e.jsxs)("div",{className:w.info,children:[(0,e.jsx)("div",{className:w.title,style:{color:y?"#FFFFFF":void 0},children:(t==null?void 0:t.name)||"\u672A\u77E5"}),(0,e.jsxs)("div",{className:w.meta,style:{color:y?"#FFFFFF":void 0},children:[(0,e.jsx)("div",{className:w.icon,children:(0,e.jsx)(ie.UserOutlined,{})}),(k==null?void 0:k.name)||"\u672A\u77E5\u4F5C\u8005"]}),(0,e.jsxs)("div",{className:w.meta,style:{color:y?"#FFFFFF":void 0},children:[(0,e.jsx)("div",{className:w.icon,children:(0,e.jsx)(ie.BookOutlined,{})}),(d==null?void 0:d.name)||"\u672A\u77E5\u7CFB\u5217"]}),(0,e.jsxs)("div",{className:w.meta,style:{color:y?"#FFFFFF":void 0},children:[(0,e.jsx)("div",{className:w.icon,children:(0,e.jsx)(ie.GlobalOutlined,{})}),(o==null?void 0:o.name)||"\u672A\u77E5\u4E3B\u9898"]})]})]})})})},rn=an,Ce={main:"main___zYwxc",cover:"cover___xlhli",title:"title___s7FpO",author:"author___kEQxf",titleSelected:"titleSelected___GbSUE",authorSelected:"authorSelected____IQBm",coverWrap:"coverWrap___pTtxO",cardContentSelected:"cardContentSelected____diXi"},on=n(44519);function ln(v){var r=v.book,t=v.onSelectAction,f=v.onAddToCollectionAction,s=v.isSelected,u=s===void 0?!1:s,y=v.onBookClick,B=(0,Pe.i)(r),p=B.author,T=function(){t(r)},k=function(){f(r)},d=(0,e.jsxs)(U.Z,{children:[(0,e.jsxs)(U.Z.Item,{onClick:T,children:[(0,e.jsx)(te(),{}),u?"\u53D6\u6D88\u9009\u4E2D":"\u9009\u4E2D"]},"1"),(0,e.jsxs)(U.Z.Item,{onClick:k,children:[(0,e.jsx)(Oe(),{}),"\u52A0\u5165\u96C6\u5408"]},"2"),(0,e.jsxs)(U.Z.Item,{onClick:k,children:[(0,e.jsx)(on.Z,{}),"\u4ECE\u6587\u4EF6\u540D\u89E3\u6790"]},"3")]}),o=function(){y!==void 0&&y(r)};return(0,e.jsx)(se.Z,{overlay:d,trigger:["contextMenu"],children:(0,e.jsx)(Te.Z,{className:Ce.main,hoverable:!0,cover:(0,e.jsx)("div",{className:Ce.coverWrap,children:(0,e.jsx)(ze.Z,{className:Ce.cover,url:r.cover})}),style:{backgroundColor:u?"#1890ff":void 0},onClick:o,children:(0,e.jsxs)("div",{children:[(0,e.jsx)("div",{id:"title",className:u?Ce.titleSelected:Ce.title,children:r.name}),(0,e.jsx)("div",{id:"author",className:u?Ce.authorSelected:Ce.author,children:(p==null?void 0:p.name)||""})]})})})}function sn(v){var r=v.books,t=r===void 0?[]:r,f=v.selectedBooks,s=f===void 0?[]:f,u=v.onSelectAction,y=v.onAddToCollectionAction,B=v.onBookClick,p=v.onParseFromName,T=v.type,k=T===void 0?"vertical":T,d=t==null?void 0:t.map(function(o){return(0,e.jsxs)(ae.Z,{children:[k==="vertical"&&(0,e.jsx)(ln,{book:o,onSelectAction:u,onAddToCollectionAction:y,isSelected:!!(s!=null&&s.find(function(i){return i.id===o.id})),onBookClick:B}),k==="horizon"&&(0,e.jsx)(rn,{book:o,onSelectAction:u,onAddToCollectionAction:y,isSelected:!!(s!=null&&s.find(function(i){return i.id===o.id})),onBookClick:B,onParseFromName:p})]},o.id)});return(0,e.jsx)(xe.Z,{gutter:16,className:de.main,children:d})}var He=n(24757),H=n(85408),re=n(72741),cn=n(33063),un={pageWrap:"pageWrap___VXmeV",filterWrap:"filterWrap___DtFrq",actionContainer:"actionContainer___U3BDL",actionButton:"actionButton___e_OAv",toolHeader:"toolHeader___IM_G7"},I=n(59496),Xe=n(56456),dn=n(83672),Je=n(2111),ce=n(23153),Me=n(91480);function hn(v){var r=v.filter,t=v.orderItems,f=v.onFilterChange,s=function(){return r.order.map(function(o){var i=t.find(function(A){return o.orderKey===A.key}),F=function(){f(l()(l()({},r),{},{order:r.order.filter(function(S){return o.orderKey!==S.orderKey})}))};return(0,e.jsxs)(ce.Z,{color:"geekblue",closable:!0,onClose:F,children:[i==null?void 0:i.title,o.order==="asc"?" \u5347\u5E8F":" \u964D\u5E8F"]},o.orderKey)})},u=function(){if(r.nameSearch!==void 0){var o=function(){f(l()(l()({},r),{},{nameSearch:void 0}))};return(0,e.jsx)(ce.Z,{color:"geekblue",closable:!0,onClose:o,children:"\u641C\u7D22: ".concat(r.nameSearch)},"nameSearch")}},y=function(){if(r.pathSearch!==void 0){var o=function(){f(l()(l()({},r),{},{pathSearch:void 0}))};return(0,e.jsx)(ce.Z,{color:"geekblue",closable:!0,onClose:o,children:"\u8DEF\u5F84\u641C\u7D22: ".concat(r.pathSearch)},"nameSearch")}},B=function(){if(r.endTime&&r.startTime){var o=function(){f(l()(l()({},r),{},{startTime:void 0,endTime:void 0}))};return(0,e.jsx)(ce.Z,{color:"geekblue",closable:!0,onClose:o,children:"\u521B\u5EFA\u65F6\u95F4:".concat(r.startTime," \u81F3 ").concat(r.endTime)},"createTimeRange")}},p=function(){return r.tags.map(function(o){var i=function(){f(l()(l()({},r),{},{tags:r.tags.filter(function(A){return A.id!==o.id})}))};return(0,e.jsx)(ce.Z,{color:"geekblue",closable:!0,onClose:i,children:"\u6807\u7B7E:".concat(o.name)},o.id+"tag")})},T=function(){return r.library.map(function(o){var i=function(){f(l()(l()({},r),{},{library:r.library.filter(function(A){return A.id!==o.id})}))};return(0,e.jsx)(ce.Z,{color:"geekblue",closable:!0,onClose:i,children:"\u4E66\u5E93:".concat(o.name," (").concat(o.id,")")},o.id+"library")})},k=function(){var o;if(r.tagSearch){var i=(o=r.tagSearchType)!==null&&o!==void 0?o:"All",F=function(){f(l()(l()({},r),{},{tagSearch:void 0,tagSearchType:void 0}))};return(0,e.jsx)(ce.Z,{color:"geekblue",closable:!0,onClose:F,children:"\u641C\u7D22\u6807\u7B7E:".concat(r.tagSearch," (").concat(i,")")},r.tagSearch)}};return(0,e.jsxs)(Me.Z,{title:"\u5DF2\u6FC0\u6D3B",children:[s(),u(),B(),p(),T(),y(),k()]})}var $=n(4855),vn=n(79584),mn=n(32699),$e={fieldLabel:"fieldLabel___gUeV5",selectTypeInput:"selectTypeInput___OdmRJ",field:"field___sCALY",addButton:"addButton____0_U0"},ke=$.Z.Option;function fn(v){var r=v.isFetching,t=r===void 0?!1:r,f=v.onSearch,s=v.tags,u=s===void 0?[]:s,y=v.onAddTag,B=(0,I.useState)([]),p=b()(B,2),T=p[0],k=p[1],d=(0,I.useState)(void 0),o=b()(d,2),i=o[0],F=o[1],A=function(C){k(C)},S=function(){return u==null?void 0:u.map(function(C){return(0,e.jsx)(ke,{value:C.id,children:C.name},C.id)})},N=(0,mn.debounce)(function(x){f(x,i)},800),j=function(C){F(C==="all"?void 0:C)},Z=function(){y(T)};return(0,e.jsxs)(Me.Z,{title:"\u6807\u7B7E",children:[(0,e.jsxs)("div",{className:$e.field,children:[(0,e.jsx)("span",{className:$e.fieldLabel,children:"\u7C7B\u522B"}),(0,e.jsxs)($.Z,{size:"small",defaultValue:"all",className:$e.selectTypeInput,onChange:j,children:[(0,e.jsx)(ke,{value:"all",children:"\u6240\u6709"},"all"),(0,e.jsx)(ke,{value:"artist",children:"\u827A\u672F\u5BB6"},"artist"),(0,e.jsx)(ke,{value:"translator",children:"\u7FFB\u8BD1"},"translator"),(0,e.jsx)(ke,{value:"series",children:"\u7CFB\u5217"},"series"),(0,e.jsx)(ke,{value:"theme",children:"\u4E3B\u9898"},"theme")]})]}),(0,e.jsx)($.Z,{mode:"multiple",labelInValue:!0,size:"small",value:T,placeholder:"\u9009\u62E9\u6807\u7B7E",notFoundContent:t?(0,e.jsx)(vn.Z,{size:"small"}):null,filterOption:!1,onSearch:N,onChange:A,style:{width:"100%"},children:S()}),(0,e.jsx)(H.ZP,{type:"primary",className:$e.addButton,onClick:Z,disabled:T.length===0,children:"\u6DFB\u52A0"})]})}var Ge={addButton:"addButton___y1r5X",select:"select___oNLKD"},Ye=n(957);function gn(v){var r=v.onAddLibrary,t=(0,I.useState)([]),f=b()(t,2),s=f[0],u=f[1],y=(0,I.useState)(),B=b()(y,2),p=B[0],T=B[1],k=function(){var o=R()(O()().mark(function i(){var F;return O()().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,Ye.tx)({pageSize:1e3});case 2:F=S.sent,u(F.result);case 4:case"end":return S.stop()}},i)}));return function(){return o.apply(this,arguments)}}();(0,I.useEffect)(function(){k()},[]);var d=function(){if(p){var i=s.find(function(F){return F.id===p});i&&r(i)}};return(0,e.jsxs)(Me.Z,{title:"\u4E66\u5E93",children:[(0,e.jsx)($.Z,{onChange:function(i){return T(Number(i))},className:Ge.select,children:s.map(function(o){return(0,e.jsx)($.Z.Option,{value:o.id,children:"".concat(o.name," (").concat(o.id,")")})})}),(0,e.jsx)(H.ZP,{type:"primary",htmlType:"submit",className:Ge.addButton,onClick:d,children:"\u6DFB\u52A0"})]})}var pn=n(98823),_e={addButton:"addButton___fG9Rm",rangeInput:"rangeInput___vImb0"},Sn=pn.default.RangePicker;function xn(v){var r=v.onAddRangeChange,t=(0,I.useState)([]),f=b()(t,2),s=f[0],u=f[1],y=function(T,k){u(k)},B=function(){var T=b()(s,2),k=T[0],d=T[1];r(k,d)};return(0,e.jsxs)(Me.Z,{title:"\u521B\u5EFA\u65F6\u95F4",children:[(0,e.jsx)(Sn,{className:_e.rangeInput,size:"small",onChange:y}),(0,e.jsx)(H.ZP,{type:"primary",htmlType:"submit",className:_e.addButton,onClick:B,disabled:s.length<2,children:"\u6DFB\u52A0"})]})}var he=n(50468),We={addButton:"addButton___ULi7T",nameInput:"nameInput___eKP7f"},Cn=function(r){var t=r.onAdd,f=(0,I.useState)(),s=b()(f,2),u=s[0],y=s[1],B=(0,I.useState)(),p=b()(B,2),T=p[0],k=p[1],d=function(){u&&t(u,T)};return(0,e.jsxs)(Me.Z,{title:"\u5305\u542B\u6807\u7B7E\u641C\u7D22",children:[(0,e.jsx)(he.Z,{size:"small",placeholder:"name",className:We.nameInput,onChange:function(i){return y(i.target.value)}}),(0,e.jsx)(he.Z,{size:"small",placeholder:"type",className:We.nameInput,onChange:function(i){return k(i.target.value)}}),(0,e.jsx)(H.ZP,{type:"primary",htmlType:"submit",className:We.addButton,onClick:d,disabled:u===void 0,children:"Add"})]})},jn=Cn,Qe=[{key:"id",title:"ID"},{key:"name",title:"\u540D\u79F0"},{key:"created_at",title:"\u521B\u5EFA\u65F6\u95F4"},{key:"updated_at",title:"\u4FEE\u6539\u65F6\u95F4"}];function yn(v){var r=v.isOpen,t=r===void 0?!1:r,f=v.onClose,s=v.onFilterChange,u=v.filter,y=v.isTagFetching,B=v.onTagSearch,p=v.searchTags,T=function(j,Z){var x=u.order.filter(function(C){return C.orderKey!==j});s(l()(l()({},u),{},{order:[].concat(P()(x),[{orderKey:j,order:Z}])}))},k=function(j){s(j)},d=function(j){s(l()(l()({},u),{},{nameSearch:j}))},o=function(j){s(l()(l()({},u),{},{pathSearch:j}))},i=function(j,Z){s(l()(l()({},u),{},{startTime:j,endTime:Z}))},F=function(j){s(l()(l()({},u),{},{tags:j.map(function(Z){return{id:Z.value,name:Z.label}})}))},A=function(j){var Z=[].concat(P()(u.library.filter(function(x){return x.id!==j.id})),[j]);s(l()(l()({},u),{},{library:Z}))},S=function(j,Z){s(l()(l()({},u),{},{tagSearch:j,tagSearchType:Z}))};return(0,e.jsxs)(Xe.Z,{title:"\u8FC7\u6EE4\u5668",placement:"right",closable:!1,onClose:f,visible:t,width:320,children:[(0,e.jsx)(hn,{orderItems:Qe,filter:u,onFilterChange:k}),(0,e.jsx)(re.Z,{}),(0,e.jsx)(dn.Z,{orderItems:Qe,onAddFilter:T,defaultOrderKey:"id"}),(0,e.jsx)(re.Z,{}),(0,e.jsx)(Je.Z,{onSetSearchName:d,title:"Name Search"}),(0,e.jsx)(re.Z,{}),(0,e.jsx)(xn,{onAddRangeChange:i}),(0,e.jsx)(re.Z,{}),(0,e.jsx)(jn,{onAdd:S}),(0,e.jsx)(re.Z,{}),(0,e.jsx)(fn,{isFetching:y,onSearch:B,tags:p,onAddTag:F}),(0,e.jsx)(re.Z,{}),(0,e.jsx)(gn,{onAddLibrary:A}),(0,e.jsx)(re.Z,{}),(0,e.jsx)(Je.Z,{onSetSearchName:o,title:"\u8DEF\u5F84\u641C\u7D22"})]})}var Tn=n(335),Ue=n.n(Tn),Ze=n(18603),X=n(74839),be=n(95157),kn=function(){var r=(0,I.useState)([]),t=b()(r,2),f=t[0],s=t[1],u=function(){var d=localStorage.getItem("replace_rule");return d?JSON.parse(d):[]},y=function(d){localStorage.setItem("replace_rule",JSON.stringify(d)),s(P()(d))},B=function(d){var o=f;o.push(d),y(o)},p=function(d,o){var i=f.map(function(F){return F.old===d&&(F.enable=o),F});y(i)},T=function(d){y(d),s(P()(d))};return(0,I.useEffect)(function(){s(u)},[]),{patterns:f,addRule:B,switchEnable:p,updateList:T}},we=kn,Ke={headerItem:"headerItem___piOvT",patternSelect:"patternSelect___S_Ei9",headerContainer:"headerContainer___hXK8I"},Zn=n(8891),bn=function(r){var t=r.style,f=r.onChange,s=we(),u=(0,I.useState)(),y=b()(u,2),B=y[0],p=y[1],T=(0,I.useState)(),k=b()(T,2),d=k[0],o=k[1],i=function(){B&&s.addRule({old:B,to:d!=null?d:"",enable:!1})},F=function(S){var N=s.patterns.map(function(j){return j.enable=!!S.find(function(Z){return Z===j.old}),j});s.updateList(P()(N)),f(N)};return(0,e.jsx)($.Z,{style:t,mode:"multiple",defaultActiveFirstOption:!0,onChange:F,value:s.patterns.filter(function(A){return A.enable}).map(function(A){return A.old}),tagRender:function(S){return(0,e.jsx)("div",{},S.value)},dropdownRender:function(S){return(0,e.jsxs)(e.Fragment,{children:[S,(0,e.jsx)(re.Z,{style:{margin:"8px 0"}}),(0,e.jsxs)(Ze.Z,{style:{padding:"0 8px 4px"},children:[(0,e.jsx)(he.Z,{placeholder:"Old value",onChange:function(j){return p(j.currentTarget.value)}}),(0,e.jsx)(he.Z,{placeholder:"To value",onChange:function(j){return o(j.currentTarget.value)}}),(0,e.jsx)(H.ZP,{type:"text",icon:(0,e.jsx)(Zn.Z,{}),onClick:i})]})]})},children:s.patterns.map(function(A,S){return(0,e.jsxs)($.Z.Option,{value:A.old,children:[A.old+" -> "," ",A.to]},S)})})},Bn=bn,qe=n(6300),An={name:"red",artist:"orange",series:"lime",theme:"blue",translator:"purple"},Fn={name:"Replace Series Brackets",match:"series",type:"modify",enable:!0,modify:function(r){return console.log("use replaceSeriesBrackets"),r.replace(")","").replace("(","").replace("\u3010","").replace("\u3011","").replace("[","").replace("]","")}},In={name:"Exclude MJK Tag",match:"series",type:"test",enable:!1,test:function(r){var t=new RegExp("^MJK-.*?$");return console.log("".concat(r," ").concat(!t.test(r))),t.test(r)}},Nn=function(r){var t=r.onClose,f=r.isOpen,s=r.books,u=r.onOk,y=(0,I.useState)([]),B=b()(y,2),p=B[0],T=B[1],k=(0,I.useState)([Fn,In]),d=b()(k,2),o=d[0],i=d[1],F=we();(0,I.useEffect)(function(){T(s.map(function(Z){var x=Z.name;return F.patterns.forEach(function(C){C.enable&&(x=x.replace(C.old,C.to))}),{value:x,book:Z,tags:[],selected:!1}}))},[s]);var A=function(){var Z=R()(O()().mark(function x(){var C,z;return O()().wrap(function(K){for(;;)switch(K.prev=K.next){case 0:return K.next=2,(0,qe.V2)(p.map(function(je){return je.value}));case 2:C=K.sent,z=p.map(function(je,Be){var ve=C[Be].result,ue=Ue()(o),ye;try{var D=function(){var oe=ye.value;if(!oe.enable)return 1;ve=ve.filter(function(pe){return!(oe.match==pe.type&&oe.test&&oe.test(pe.name))})};for(ue.s();!(ye=ue.n()).done;)D()}catch(ge){ue.e(ge)}finally{ue.f()}var m=Ue()(ve),G;try{for(m.s();!(G=m.n()).done;){var W=G.value,me=Ue()(o),Y;try{for(me.s();!(Y=me.n()).done;){var fe=Y.value;fe.enable&&fe.match==W.type&&fe.modify&&(W.name=fe.modify(W.name),console.log(fe.modify(W.name)))}}catch(ge){me.e(ge)}finally{me.f()}}}catch(ge){m.e(ge)}finally{m.f()}return l()(l()({},je),{},{tags:ve})}),T(P()(z));case 5:case"end":return K.stop()}},x)}));return function(){return Z.apply(this,arguments)}}(),S=function(){var x=p.filter(function(C){return C.selected}).filter(function(C){return C.tags.find(function(z){return z.type==="name"})!=null});u(x.map(function(C){var z,J;return{id:C.book.id,title:(z=(J=C.tags.find(function(K){return K.type==="name"}))===null||J===void 0?void 0:J.name)!==null&&z!==void 0?z:C.book.name,tags:C.tags.filter(function(K){return K.type!=="name"})}}))},N=function(x,C){var z=p.map(function(J){return J.book.id===C?l()(l()({},J),{},{value:x}):J});T(P()(z))},j=function(x){var C=p.map(function(z){var J=z.book.name;return l()(l()({},z),{},{value:J})});T(P()(C))};return(0,e.jsx)(Xe.Z,{title:"\u6279\u91CF\u7F16\u8F91",placement:"right",onClose:t,visible:f,width:"90%",extra:(0,e.jsxs)("div",{className:Ke.headerContainer,children:[(0,e.jsx)($.Z,{mode:"multiple",style:{width:300},placeholder:"Please select",defaultValue:o.filter(function(Z){return Z.enable}).map(function(Z){return Z.name}),tagRender:function(x){return(0,e.jsx)("span",{})},onChange:function(x){i(o.map(function(C){return l()(l()({},C),{},{enable:x.includes(C.name)})}))},options:o.map(function(Z){return{label:Z.name,value:Z.name}})}),(0,e.jsx)(Ze.Z,{}),(0,e.jsx)(H.ZP,{onClick:A,type:"primary",className:Ke.headerItem,children:"Match"}),(0,e.jsx)("span",{className:Ke.headerItem,children:(0,e.jsx)(Bn,{style:{width:240},onChange:j})}),(0,e.jsx)(H.ZP,{onClick:S,type:"primary",className:Ke.headerItem,children:"Apply"})]}),children:(0,e.jsx)(X.Z,{size:"small",dataSource:p,renderItem:function(x){return(0,e.jsx)(X.Z.Item,{children:(0,e.jsxs)("div",{style:{flex:1},children:[(0,e.jsxs)("div",{style:{flex:1,display:"flex"},children:[(0,e.jsx)(Ze.Z,{children:(0,e.jsx)(be.Z,{checked:x.selected,onChange:function(z){var J=P()(p.map(function(K){return K.book.id===x.book.id?l()(l()({},K),{},{selected:z.target.checked}):K}));T(J)}})}),(0,e.jsx)(he.Z,{size:"small",onChange:function(z){return N(z.target.value,x.book.id)},value:x.value,style:{marginLeft:16,border:"none"}})]}),(0,e.jsx)("div",{children:x.tags.map(function(C){return(0,e.jsx)(Ze.Z,{children:(0,e.jsx)(ce.Z,{color:An[C.type],children:C.name})},C.id)})})]})})}})})},On=Nn,Pn=n(67825),Mn=n.n(Pn),L={root:"root___D7A13",pattern:"pattern___kRSmN",checkbox:"checkbox___cpXMX",selectType:"selectType___o0e7o",list:"list___Xp57r",left:"left___pG6O3",right:"right___sGBaX",label:"label___pDjbU",tag:"tag___UovFS",quickAction:"quickAction___snj8S",actions:"actions___Ge8Sa"},en=n(48016),De=n(78501),nn=n(43448),Dn=n(89333),Rn=n(33269),En=n.n(Rn),Ve=function(r){for(var t=[],f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",s=f.length,u=0;u<r;u++)t.push(f.charAt(Math.floor(Math.random()*s)));return t.join("")},Ln=["onMatchOk","text"],Re=en.Z.TabPane,zn={name:"red",artist:"orange",series:"lime",theme:"blue",translator:"purple"},$n=function(r){var t=r.onMatchOk,f=r.text,s=f===void 0?"":f,u=Mn()(r,Ln),y=(0,I.useState)(s),B=b()(y,2),p=B[0],T=B[1],k=(0,I.useState)([]),d=b()(k,2),o=d[0],i=d[1],F=(0,I.useState)([]),A=b()(F,2),S=A[0],N=A[1],j=(0,I.useState)(),Z=b()(j,2),x=Z[0],C=Z[1],z=(0,I.useState)(),J=b()(z,2),K=J[0],je=J[1],Be=function(){var a=localStorage.getItem("save_pattern");return a?JSON.parse(a):[]},ve=(0,I.useState)(Be()),ue=b()(ve,2),ye=ue[0],D=ue[1],m=(0,Dn.Z)(p),G=function(a,h){var c=h.find(function(M){return M.type===a&&M.source==="ai"});return c||(c=h.find(function(M){return M.type===a&&M.source==="database"}),c)},W=function(a){for(var h=["artist","name","series","theme","translator"],c=[],M=0,V=h;M<V.length;M++){var Fe=V[M],Se=G(Fe,a);Se&&c.push(Se.id)}N(c)},me=function(){var g=R()(O()().mark(function a(h){var c;return O()().wrap(function(V){for(;;)switch(V.prev=V.next){case 0:return V.next=2,(0,qe.AB)(h);case 2:c=V.sent,i(c),W(c);case 5:case"end":return V.stop()}},a)}));return function(h){return g.apply(this,arguments)}}(),Y=function(){i([].concat(P()(o),[{id:Ve(7),name:"",type:"",source:"custom"}]))};(0,I.useEffect)(function(){me(m)},[m]);var fe=function(){var a=[],h=Ue()(S),c;try{var M=function(){var Fe=c.value,Se=o.find(function(Yn){return Yn.id===Fe});Se&&a.push(Se)};for(h.s();!(c=h.n()).done;)M()}catch(V){h.e(V)}finally{h.f()}return a},ge=function(){var a=fe(),h=void 0,c=a.find(function(M){return M.type==="name"});c&&(h=c.name),a=a.filter(function(M){return M.type!=="name"}),t(h,a)},oe=function(a){if(a.source==="raw"||a.source==="custom"){var h=function(M){i(o.map(function(V){return V.id===a.id?l()(l()({},V),{},{type:M}):l()({},V)}))};return(0,e.jsxs)("div",{children:[(0,e.jsxs)($.Z,{size:"small",className:L.selectType,onChange:h,value:a.type,children:[(0,e.jsx)($.Z.Option,{value:"artist",children:"artist"}),(0,e.jsx)($.Z.Option,{value:"series",children:"series"}),(0,e.jsx)($.Z.Option,{value:"theme",children:"theme"}),(0,e.jsx)($.Z.Option,{value:"translator",children:"translator"}),(0,e.jsx)($.Z.Option,{value:"name",children:"name"})]}),"| raw"]})}return(0,e.jsxs)("div",{children:[(0,e.jsx)(De.Z.Text,{strong:!0,children:a.type})," | ",a.source]})},pe=function(a){return(a.source==="raw"||a.source==="custom")&&a.type.length===0},Ae=function(a,h){var c=S;h?c=[].concat(P()(c.filter(function(M){return M!==a})),[a]):c=c.filter(function(M){return M!==a}),N(c)},Hn=function(a){var h=zn[a.type];h||(h="green");var c=function(){Ae(a.id,!1)};return(0,e.jsx)("div",{className:L.tag,children:(0,e.jsx)(ce.Z,{color:h,onClose:c,closable:!0,children:"".concat(a.type,": ").concat(a.name)})},a.id)},Xn=function(a,h){i(o.map(function(c){return c.id===a?l()(l()({},c),{},{name:h}):l()({},c)}))},Ee=function(a){if(x){var h=Ve(7);i([].concat(P()(o),[{id:h,name:x,type:a,source:"custom"}])),N([].concat(P()(S),[h]))}},Jn=function(){console.log(K),localStorage.setItem("save_pattern",JSON.stringify([K].concat(P()(ye)))),D(Be())},Gn=function(a){i([]);var h=new RegExp(a),c=h.exec(p),M=[],V=P()(S);c!=null&&c.groups&&Object.getOwnPropertyNames(c.groups).forEach(function(Fe){var Se=Ve(7);M.push({id:Se,name:c.groups[Fe],type:Fe,source:"custom"}),V.push(Se)}),i(M),N(V)};return(0,e.jsxs)(nn.Z,l()(l()({title:"\u5339\u914D\u6807\u7B7E"},u),{},{className:L.root,onOk:ge,width:720,children:[(0,e.jsx)(he.Z,{value:p,onChange:function(a){return T(a.target.value)},onSelect:function(a){var h=a.currentTarget.selectionStart,c=a.currentTarget.selectionEnd;h&&c&&C(a.currentTarget.value.substring(h,c))}}),(0,e.jsxs)($.Z,{style:{width:"100%",marginTop:8,position:"sticky"},defaultActiveFirstOption:!0,onSelect:Gn,dropdownRender:function(a){return(0,e.jsxs)(e.Fragment,{children:[a,(0,e.jsx)(re.Z,{style:{margin:"8px 0"}}),(0,e.jsxs)(Ze.Z,{style:{padding:"0 8px 4px"},children:[(0,e.jsx)(he.Z,{placeholder:"Please enter item",onChange:function(c){return je(c.currentTarget.value)}}),(0,e.jsx)(H.ZP,{type:"text",icon:(0,e.jsx)(ie.PlusOutlined,{}),onClick:Jn,children:"Add item"})]})]})},children:[(0,e.jsx)($.Z.Option,{value:"no",children:"Not use"}),ye.map(function(g,a){return(0,e.jsx)($.Z.Option,{value:g,children:g},a)})]}),(0,e.jsx)("div",{className:L.label,children:(0,e.jsx)(De.Z.Text,{strong:!0,children:"\u5FEB\u901F\u6DFB\u52A0"})}),(0,e.jsxs)("div",{className:L.quickAction,children:[x,x&&(0,e.jsx)("div",{className:L.actions,children:(0,e.jsxs)(Ze.Z,{children:[(0,e.jsx)(H.ZP,{size:"small",onClick:function(){return Ee("name")},children:"as Name"}),(0,e.jsx)(H.ZP,{size:"small",onClick:function(){return Ee("artist")},children:"as Artist"}),(0,e.jsx)(H.ZP,{size:"small",onClick:function(){return Ee("theme")},children:"as Theme"}),(0,e.jsx)(H.ZP,{size:"small",onClick:function(){return Ee("series")},children:"as Series"}),(0,e.jsx)(H.ZP,{size:"small",onClick:function(){return Ee("translator")},children:"as Translator"})]})})]}),(0,e.jsxs)("div",{className:L.root,children:[(0,e.jsx)("div",{className:L.left,children:(0,e.jsxs)(en.Z,{defaultActiveKey:"1",children:[(0,e.jsx)(Re,{tab:"AI",children:(0,e.jsx)(X.Z,{className:L.list,dataSource:o.filter(function(g){return g.source==="ai"}),renderItem:function(a){return(0,e.jsxs)(X.Z.Item,{children:[(0,e.jsx)(be.Z,{disabled:pe(a),className:L.checkbox,checked:!!S.find(function(h){return h===a.id}),onChange:function(c){Ae(a.id,c.target.checked)}}),(0,e.jsx)(X.Z.Item.Meta,{title:a.name,description:oe(a)})]})}})},"1"),(0,e.jsx)(Re,{tab:"\u5339\u914D",children:(0,e.jsx)(X.Z,{className:L.list,dataSource:o.filter(function(g){return g.source==="pattern"||g.source==="database"}),renderItem:function(a){return(0,e.jsxs)(X.Z.Item,{children:[(0,e.jsx)(be.Z,{disabled:pe(a),className:L.checkbox,checked:!!S.find(function(h){return h===a.id}),onChange:function(c){Ae(a.id,c.target.checked)}}),(0,e.jsx)(X.Z.Item.Meta,{title:a.name,description:oe(a)})]})}})},"2"),(0,e.jsx)(Re,{tab:"\u6F5C\u5728",children:(0,e.jsx)(X.Z,{className:L.list,dataSource:o.filter(function(g){return g.source==="raw"}),renderItem:function(a){return(0,e.jsxs)(X.Z.Item,{children:[(0,e.jsx)(be.Z,{disabled:pe(a),className:L.checkbox,checked:!!S.find(function(h){return h===a.id}),onChange:function(c){Ae(a.id,c.target.checked)}}),(0,e.jsx)(X.Z.Item.Meta,{title:a.name,description:oe(a)})]})}})},"3"),(0,e.jsxs)(Re,{tab:"\u81EA\u5B9A\u4E49",children:[(0,e.jsx)(X.Z,{className:L.list,dataSource:o.filter(function(g){return g.source==="custom"}),renderItem:function(a){return(0,e.jsxs)(X.Z.Item,{children:[(0,e.jsx)(be.Z,{disabled:pe(a),className:L.checkbox,checked:!!S.find(function(h){return h===a.id}),onChange:function(c){Ae(a.id,c.target.checked)}}),(0,e.jsx)(X.Z.Item.Meta,{title:(0,e.jsx)(he.Z,{placeholder:"\u8F93\u5165\u6807\u7B7E",onChange:function(c){return Xn(a.id,c.target.value)},value:a.name}),description:oe(a)})]})}}),(0,e.jsx)(H.ZP,{icon:(0,e.jsx)(En(),{}),onClick:Y,children:"\u6DFB\u52A0"})]},"4"),(0,e.jsx)(Re,{tab:"\u6587\u672C\u66FF\u6362",children:(0,e.jsx)(X.Z,{className:L.list,dataSource:o.filter(function(g){return g.source==="raw"}),renderItem:function(a){return(0,e.jsxs)(X.Z.Item,{children:[(0,e.jsx)(be.Z,{disabled:pe(a),className:L.checkbox,checked:!!S.find(function(h){return h===a.id}),onChange:function(c){Ae(a.id,c.target.checked)}}),(0,e.jsx)(X.Z.Item.Meta,{title:a.name,description:oe(a)})]})}})},"5")]})}),(0,e.jsxs)("div",{className:L.right,children:[(0,e.jsx)("div",{className:L.label,children:(0,e.jsx)(De.Z.Text,{strong:!0,children:"\u539F\u59CB\u540D\u79F0"})}),(0,e.jsx)(De.Z.Text,{children:s}),(0,e.jsx)("div",{className:L.label,children:(0,e.jsx)(De.Z.Text,{strong:!0,children:"\u4F7F\u7528\u7684\u6807\u7B7E"})}),(0,e.jsx)("div",{children:fe().map(function(g){return Hn(g)})})]})]})]}))},Un=$n,tn={select:"select___AGbgy"},Kn=function(r){var t=r.onOk,f=r.onCancel,s=r.isOpen,u=s===void 0?!1:s,y=(0,I.useState)([]),B=b()(y,2),p=B[0],T=B[1],k=(0,I.useState)(),d=b()(k,2),o=d[0],i=d[1],F=function(){var S=R()(O()().mark(function N(){var j;return O()().wrap(function(x){for(;;)switch(x.prev=x.next){case 0:return x.next=2,(0,Ye.tx)({page_size:1e3});case 2:j=x.sent,T(j.result);case 4:case"end":return x.stop()}},N)}));return function(){return S.apply(this,arguments)}}();(0,I.useEffect)(function(){u&&F()},[u]);var A=function(){o&&t(Number(o))};return(0,e.jsx)(nn.Z,{visible:u,title:"\u9009\u62E9\u4E66\u5E93",onCancel:f,onOk:A,children:(0,e.jsx)($.Z,{value:o,onChange:function(N){return i(N)},className:tn.select,placeholder:"\u9009\u62E9\u4E66\u5E93",children:p.map(function(S){return(0,e.jsx)($.Z.Option,{value:S.id,className:tn.select,children:S.name})})})})},Wn=function(){var r,t=(0,He.useModel)("YouComic.bookList"),f=(0,I.useState)(!1),s=b()(f,2),u=s[0],y=s[1],B=(0,I.useState)(!1),p=b()(B,2),T=p[0],k=p[1],d=(0,I.useState)(!1),o=b()(d,2),i=o[0],F=o[1],A=(0,I.useState)(!1),S=b()(A,2),N=S[0],j=S[1];(0,I.useEffect)(function(){t.loadData({})},[]);var Z=function(m){var G=!!t.selectedBooks.find(function(W){return W.id===m.id});G?t.setSelectedBooks(t.selectedBooks.filter(function(W){return W.id!==m.id})):t.setSelectedBooks([].concat(P()(t.selectedBooks),[m]))},x=function(m){t.selectedBooks.length>0?Z(m):He.history.push("/youcomic/book/".concat(m.id,"/base"))},C=function(){var D=R()(O()().mark(function m(G,W){return O()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:return Y.next=2,t.searchBookTags({searchKey:G,type:W});case 2:case"end":return Y.stop()}},m)}));return function(G,W){return D.apply(this,arguments)}}(),z=function(m){t.updateFilter(l()(l()({},t.filter),{},{startTime:m.startTime,endTime:m.endTime,nameSearch:m.nameSearch,pathSearch:m.pathSearch,order:m.order,tags:m.tags,library:m.library,libraryIds:m.libraryIds,tagSearch:m.tagSearch,tagSearchType:m.tagSearchType}))},J=function(){var D=R()(O()().mark(function m(G,W){return O()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(F(!1),t.contextBook){Y.next=3;break}return Y.abrupt("return");case 3:if(!G){Y.next=6;break}return Y.next=6,t.updateList({books:[{id:t.contextBook.id,title:G,tags:W}]});case 6:case"end":return Y.stop()}},m)}));return function(G,W){return D.apply(this,arguments)}}(),K=function(m){t.updateList({books:m})},je=function(){t.setSelectedBooks(t.books)},Be=function(){var m;t.setSelectedBooks((m=t.books)===null||m===void 0?void 0:m.filter(function(G){return t.selectedBooks.find(function(W){return W.id===G.id})===void 0}))},ve=function(){t.setSelectedBooks([])},ue=[{key:"selectAll",label:"Select all"},{key:"selectNone",label:"Select none"},{key:"reverseSelect",label:"Reverse select"},{type:"divider"},{key:"matchSelect",label:"Match select book"},{type:"divider"},{key:"moveToOtherLibrary",label:"Move to other library"},{type:"divider"},{key:"delete",label:"Delete"},{key:"deletePermanently",label:"Delete permanently"}],ye=function(m){switch(m.key){case"selectAll":je();break;case"selectNone":ve();break;case"reverseSelect":Be();break;case"moveToOtherLibrary":j(!0);break;case"delete":t.deleteSelectedBooks({permanently:!1});break;case"deletePermanently":t.deleteSelectedBooks({permanently:!0});break;case"matchSelect":t.matchSelectBook();break}};return(0,e.jsxs)(_._z,{extra:(0,e.jsxs)(e.Fragment,{children:[t.selectedBooks.length>0&&(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(se.Z,{menu:{items:ue,onClick:ye},children:(0,e.jsxs)(H.ZP,{type:"primary",children:["Selected ",t.selectedBooks.length," items"]})}),(0,e.jsx)(re.Z,{type:"vertical"})]}),(0,e.jsx)(H.ZP,{onClick:function(){return k(!0)},children:"Batch Match"}),(0,e.jsx)(H.ZP,{type:"primary",onClick:function(){return y(!0)},children:"Filter"})]}),children:[i&&(0,e.jsx)(Un,{visible:!0,onMatchOk:J,onCancel:function(){return F(!1)},text:(r=t.contextBook)===null||r===void 0?void 0:r.dirName}),(0,e.jsx)(Kn,{onCancel:function(){return j(!1)},isOpen:N,onOk:function(m){return t.move({id:m})}}),(0,e.jsx)(On,{onClose:function(){return k(!1)},isOpen:T,books:t.books,onOk:K}),(0,e.jsx)(yn,{onClose:function(){return y(!1)},isOpen:u,filter:t.filter,onFilterChange:z,searchTags:t.searchTags,onTagSearch:C}),(0,e.jsx)(sn,{books:t.books,onSelectAction:Z,selectedBooks:t.selectedBooks,onAddToCollectionAction:function(){},onBookClick:x,type:"horizon",onParseFromName:function(m){t.setContextBook(m),F(!0)}}),(0,e.jsx)("div",{className:un.pageWrap,children:(0,e.jsx)(cn.Z,{defaultCurrent:1,total:t.pagination.total,current:t.pagination.page,pageSize:t.pagination.pageSize,pageSizeOptions:[25,35,50,75,100,200,300,1e3],onChange:function(m,G){t.updatePagination(m,G)}})})]})},Vn=Wn},50451:function(Ie,ee,n){n.d(ee,{i:function(){return ne}});function ne(l){var Q,O,q,R,le=l==null||(Q=l.tags)===null||Q===void 0?void 0:Q.find(function(_){return _.type==="series"}),P=l==null||(O=l.tags)===null||O===void 0?void 0:O.find(function(_){return _.type==="artist"}),E=l==null||(q=l.tags)===null||q===void 0?void 0:q.find(function(_){return _.type==="theme"}),b=l==null||(R=l.tags)===null||R===void 0?void 0:R.find(function(_){return _.type==="translator"});return{series:le,author:P,theme:E,translator:b}}}}]);

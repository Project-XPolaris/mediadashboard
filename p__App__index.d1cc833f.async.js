"use strict";(self.webpackChunkmediadashboard=self.webpackChunkmediadashboard||[]).push([[202],{24315:function(ue,G,r){var z=r(6614),f=r(56453),H=r(87906),x=r(47746),X=r(92094),q=r(25030),V=r(16760),_=r(59496),w=r(90750),A=r(4637),v=["fieldProps","proFieldProps"],ee=["fieldProps","proFieldProps"],C="text",ne=function(i){var a=i.fieldProps,O=i.proFieldProps,j=(0,H.Z)(i,v);return(0,A.jsx)(w.Z,(0,f.Z)({valueType:C,fieldProps:a,filedConfig:{valueType:C},proFieldProps:O},j))},F=function(i){var a=(0,x.Z)(i.open||!1,{value:i.open,onChange:i.onOpenChange}),O=(0,z.Z)(a,2),j=O[0],N=O[1];return(0,A.jsx)(X.Z.Item,{shouldUpdate:!0,noStyle:!0,children:function(n){var k,E=n.getFieldValue(i.name||[]);return(0,A.jsx)(q.Z,(0,f.Z)((0,f.Z)({getPopupContainer:function(c){return c&&c.parentNode?c.parentNode:c},onOpenChange:function(c){return N(c)},content:(0,A.jsxs)("div",{style:{padding:"4px 0"},children:[(k=i.statusRender)===null||k===void 0?void 0:k.call(i,E),i.strengthText?(0,A.jsx)("div",{style:{marginTop:10},children:(0,A.jsx)("span",{children:i.strengthText})}):null]}),overlayStyle:{width:240},placement:"rightTop"},i.popoverProps),{},{open:j,children:i.children}))}})},re=function(i){var a=i.fieldProps,O=i.proFieldProps,j=(0,H.Z)(i,ee),N=(0,_.useState)(!1),K=(0,z.Z)(N,2),n=K[0],k=K[1];return a!=null&&a.statusRender&&j.name?(0,A.jsx)(F,{name:j.name,statusRender:a==null?void 0:a.statusRender,popoverProps:a==null?void 0:a.popoverProps,strengthText:a==null?void 0:a.strengthText,open:n,onOpenChange:k,children:(0,A.jsx)("div",{children:(0,A.jsx)(w.Z,(0,f.Z)({valueType:"password",fieldProps:(0,f.Z)((0,f.Z)({},(0,V.Z)(a,["statusRender","popoverProps","strengthText"])),{},{onBlur:function(R){var c;a==null||(c=a.onBlur)===null||c===void 0||c.call(a,R),k(!1)},onClick:function(R){var c;a==null||(c=a.onClick)===null||c===void 0||c.call(a,R),k(!0)}}),proFieldProps:O,filedConfig:{valueType:C}},j))})}):(0,A.jsx)(w.Z,(0,f.Z)({valueType:"password",fieldProps:a,proFieldProps:O,filedConfig:{valueType:C}},j))},I=ne;I.Password=re,I.displayName="ProFormComponent",G.Z=I},35927:function(ue,G,r){r.r(G),r.d(G,{default:function(){return de}});var z=r(87218),f=r(59496),H=r(23153),x=r(15238),X=r(44307),q=r(21201),V=r(85408),_=r(43591),w=r(76521),A=r(90228),v=r.n(A),ee=r(87999),C=r.n(ee),ne=r(48305),F=r.n(ne),re=r(92705),I=r(51913),B=r(24315),i=r(92094),a=r(16642),O=r(24757),j=function(){var L=C()(v()().mark(function o(p){return v()().wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.abrupt("return",(0,O.request)("".concat(p,"/info"),{method:"GET"}));case 1:case"end":return y.stop()}},o)}));return function(p){return L.apply(this,arguments)}}(),N={seg:"seg___iVIlg"},K=function(o,p,S){return(0,O.request)(o,{method:"POST",data:{username:p,password:S}})},n=r(4637),k=function(o){var p=o.open,S=o.onOk,y=o.client,$=o.trigger,Z=i.Z.useForm(),s=F()(Z,1),l=s[0],J=f.useState(),Q=F()(J,2),W=Q[0],te=Q[1],ae=f.useState(),m=F()(ae,2),e=m[0],t=m[1],g=f.useState(),u=F()(g,2),b=u[0],D=u[1],ve=function(){var U=C()(v()().mark(function d(){var h,P;return v()().wrap(function(Y){for(;;)switch(Y.prev=Y.next){case 0:if(h=l.getFieldValue("baseUrl"),h){Y.next=4;break}return x.ZP.error("Base URL is required"),Y.abrupt("return");case 4:return Y.next=6,j(h);case 6:P=Y.sent,te(P),P.auth.length>0&&t(P.auth[0]);case 9:case"end":return Y.stop()}},d)}));return function(){return U.apply(this,arguments)}}(),pe=function(){var U=C()(v()().mark(function d(){var h,P,T,Y,oe;return v()().wrap(function(M){for(;;)switch(M.prev=M.next){case 0:if(e){M.next=3;break}return x.ZP.error("Auth is required"),M.abrupt("return");case 3:if(h=l.getFieldValue("username"),P=l.getFieldValue("password"),!(!h||!P)){M.next=8;break}return x.ZP.error("Username and password are required"),M.abrupt("return");case 8:return T=l.getFieldValue("baseUrl"),Y=T+e.url,M.next=12,K(Y,h,P);case 12:oe=M.sent,D(oe.data);case 14:case"end":return M.stop()}},d)}));return function(){return U.apply(this,arguments)}}(),fe=function(){if(!e){x.ZP.error("Auth is required");return}var d=l.getFieldValue("baseUrl");if(!d){x.ZP.error("Base URL is required");return}if(e.type==="base"&&!b){x.ZP.error("Auth is required");return}var h={client:y,baseUrl:d,token:b==null?void 0:b.accessToken,username:l.getFieldValue("username")===void 0?"Anonymous":l.getFieldValue("username")};S(h)};return(0,n.jsxs)(re.Y,{title:"Link with application",form:l,autoFocusFirstInput:!0,trigger:$,modalProps:{destroyOnClose:!0,onCancel:function(){return console.log("run")}},open:p,submitTimeout:2e3,onFinish:function(){var U=C()(v()().mark(function d(h){return v()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return T.abrupt("return",!0);case 1:case"end":return T.stop()}},d)}));return function(d){return U.apply(this,arguments)}}(),submitter:{render:function(d,h){var P;return[W===void 0&&(0,n.jsx)(V.ZP,{onClick:ve,children:"Connect"}),e&&b===void 0&&e.type!=="anonymous"&&(0,n.jsx)(V.ZP,{onClick:function(){return pe()},children:"Login"}),(b||(e==null?void 0:e.type)==="anonymous")&&(0,n.jsxs)(V.ZP,{onClick:function(){fe(),d.submit()},children:["Complete with user ",(P=b==null?void 0:b.username)!==null&&P!==void 0?P:"Anonymous"]})]}},children:[(0,n.jsx)(I.UW,{children:(0,n.jsx)(B.Z,{label:"Base url",name:"baseUrl",width:"xl"})}),W&&(0,n.jsx)(a.Z,{className:N.seg,options:W.auth.map(function(U){return U.name}),value:e==null?void 0:e.name,onChange:function(d){return t(W.auth.find(function(h){return h.name===d}))}}),(e==null?void 0:e.type)==="base"&&(0,n.jsxs)(I.UW,{children:[(0,n.jsx)(B.Z,{label:"Username",name:"username",width:"xl"}),(0,n.jsx)(B.Z,{label:"Password",name:"password",width:"xl"})]}),(e==null?void 0:e.type)==="anonymous"&&(0,n.jsx)(I.UW,{children:"no auth"})]})},E=k,R=r(50659),c=function(){var o=function(){var e=localStorage.getItem("accounts");return e===null?[]:JSON.parse(e)},p=(0,f.useState)(o),S=F()(p,2),y=S[0],$=S[1],Z=function(e){var t=y.filter(function(g){return g.client!==e.client||g.baseUrl!==e.baseUrl||g.username!==e.username});t.push(e),localStorage.setItem("accounts",JSON.stringify(t)),$(t)},s=function(e){var t=y.filter(function(g){return g.baseUrl!==e.baseUrl&&g.username!==e.username});localStorage.setItem("accounts",JSON.stringify(t)),$(t)},l=function(e){var t={baseUrl:e.baseUrl,token:e.token};localStorage.setItem("YouVideoConfig",JSON.stringify(t))},J=function(){var m=C()(v()().mark(function e(t){var g,u;return v()().wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,R.ZP.get(t.baseUrl+"/info",{});case 2:g=D.sent,g.success||x.ZP.error("fetch service info failed"),u={baseUrl:t.baseUrl,token:t.token,deepdanbooruEnable:g.deepdanbooruEnable},localStorage.setItem("YouPhotoConfig",JSON.stringify(u));case 6:case"end":return D.stop()}},e)}));return function(t){return m.apply(this,arguments)}}(),Q=function(e){var t={baseUrl:e.baseUrl,token:e.token};localStorage.setItem("YouMusicConfig",JSON.stringify(t))},W=function(e){var t={baseUrl:e.baseUrl,token:e.token};localStorage.setItem("YouComicConfig",JSON.stringify(t))},te=function(){var m=C()(v()().mark(function e(t){return v()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:u.t0=t.client,u.next=u.t0==="YouVideo"?3:u.t0==="YouPhoto"?6:u.t0==="YouMusic"?9:u.t0==="YouComic"?12:15;break;case 3:return u.next=5,l(t);case 5:return u.abrupt("break",15);case 6:return u.next=8,J(t);case 8:return u.abrupt("break",15);case 9:return u.next=11,Q(t);case 11:return u.abrupt("break",15);case 12:return u.next=14,W(t);case 14:return u.abrupt("break",15);case 15:window.location.reload();case 16:case"end":return u.stop()}},e)}));return function(t){return m.apply(this,arguments)}}(),ae=function(e){var t="";switch(e.client){case"YouVideo":t="YouVideoConfig";break;case"YouPhoto":t="YouPhotoConfig";break;case"YouMusic":t="YouMusicConfig";break;case"YouComic":t="YouComicConfig"}t!==""&&(localStorage.removeItem(t),window.location.reload())};return{accounts:y,addAccount:Z,removeAccount:s,applyAccount:te,inactiveAccount:ae}},se=c,ie=function(){return localStorage.getItem("YouVideoConfig")!==null?JSON.parse(localStorage.getItem("YouVideoConfig")):null},le={activeTag:"activeTag___AGETq"},ce=function(){var o=se(),p=f.useReducer(function(){return{}},{})[1],S=function(s){switch(s.client){case"YouVideo":var l=ie();return l?l.token===s.token:!1}return!1},y=[{title:"Client",dataIndex:"client",key:"client"},{title:"BaseUrl",dataIndex:"baseUrl",key:"baseUrl"},{title:"Username",dataIndex:"username",key:"username",render:function(s,l){return(0,n.jsxs)(n.Fragment,{children:[s,S(l)?(0,n.jsx)(H.Z,{title:"Active",color:"green",className:le.activeTag,children:"Active"}):(0,n.jsx)(n.Fragment,{})]})}},{title:"Actions",dataIndex:"username",key:"username",render:function(s,l){return(0,n.jsx)(n.Fragment,{children:S(l)?(0,n.jsx)("a",{onClick:function(){return o.inactiveAccount(l)},children:"Inactive"}):(0,n.jsx)("a",{onClick:function(){o.applyAccount(l),p(),x.ZP.success("Applied ".concat(l.username))},children:"Apply"})})}}],$=(0,n.jsx)(X.Z,{items:[{key:"1",label:(0,n.jsx)(E,{onOk:function(s){o.addAccount(s),o.applyAccount(s),p()},trigger:(0,n.jsx)("a",{children:"YouVideo"}),client:"YouVideo"})},{key:"2",label:(0,n.jsx)(E,{onOk:function(s){o.addAccount(s),o.applyAccount(s),p()},trigger:(0,n.jsx)("a",{children:"YouPhoto"}),client:"YouPhoto"})},{key:"3",label:(0,n.jsx)(E,{onOk:function(s){o.addAccount(s),o.applyAccount(s),p()},trigger:(0,n.jsx)("a",{children:"YouMusic"}),client:"YouMusic"})},{key:"4",label:(0,n.jsx)(E,{onOk:function(s){o.addAccount(s),o.applyAccount(s),p()},trigger:(0,n.jsx)("a",{children:"YouComic"}),client:"YouComic"})}]});return(0,n.jsx)(z._z,{extra:(0,n.jsx)(q.Z,{overlay:$,children:(0,n.jsx)(V.ZP,{type:"primary",children:"Link with"})}),children:(0,n.jsx)(_.Z,{children:(0,n.jsx)(w.Z,{columns:y,dataSource:o.accounts})})})},de=ce}}]);
